import{d as m,r as g,q as f,j as t,Y as x}from"./app-DqVqaljI.js";import h from"./NotFound-BBZMYK4Q.js";import j from"./CityHeavenQuestion-DyuyFBWh.js";import Q from"./CityHeavenResult-BxSf1BSL.js";import v from"./Header-BR81SfMC.js";import w from"./Footer-Cqa2Aeyj.js";import{u as I}from"./store-4bwS-QNJ.js";import"./index-C5jsUDp-.js";import"./iconBase-Cbg9ZGOh.js";import"./react-9UC6Oz1t.js";import"./index-DAdFyLkS.js";const N=async r=>{try{const s=await m.get(`${r}/cityheaven`);return console.log(s.data),s.data}catch(s){return console.log(s),[]}},q=async r=>(await m.get(`${r}/firstQuestionId`,{params:{flow_url:r}})).data,F=async r=>{try{const s=await m.get(`${r}/questionnaire`,{params:{flow_url:r}}),i=JSON.parse(s.data.questions),n=JSON.parse(s.data.results),c=JSON.parse(s.data.edges),d=i.map(e=>({id:e.id,topic:e.data.topic,choices:e.data.choices.map(o=>{var a;return{id:o.id,content:o.content,salesPoints:o.salePoints,nextId:(a=c.find(l=>l.sourceHandle===o.id))==null?void 0:a.targetHandle}}),category:"question"})),u=n.map(e=>({id:e.id,result:e.data.result,message:e.data.message,img:e.data.img,url:e.data.url,category:"result"}));return[...d,...u]}catch(s){return console.log(s),[]}},H=()=>{const{flowUrl:r}=f().props,{setQuestionnarieDatas:s,setCurrentQuestionnarie:i,currentQuestionnarie:n,setIsLoading:c,isLoading:d,setBaseGirlDataList:u,setisGirlsLoading:e,setFirstQuestionId:o}=I();return g.useEffect(()=>{(async()=>{try{const a=q(r),l=F(r),[p,y]=await Promise.all([a,l]);s(y),o(p),i(p),c(!1)}catch{}})(),(async()=>{try{const a=await N(r);u(a.resultArray),e(!1)}catch{e(!0)}})()},[]),t.jsxs(t.Fragment,{children:[t.jsx(x,{title:"診断"}),t.jsxs("div",{className:"w-screen h-screen overflow-auto bg-amber-50",children:[t.jsx("div",{className:"h-[5%] min-h-[45px]",children:t.jsx(v,{})}),t.jsx("div",{className:"min-h-[550px] md:min-h-[800px]",children:!d&&t.jsxs(t.Fragment,{children:[n.category==="question"&&t.jsx(j,{}),n.category==="result"&&t.jsx(Q,{}),n.category==="none"&&t.jsx(h,{})]})}),t.jsx("div",{className:"h-[5%] min-h-[45px] ",children:t.jsx(w,{})})]})]})},b=g.memo(H);export{b as default};
