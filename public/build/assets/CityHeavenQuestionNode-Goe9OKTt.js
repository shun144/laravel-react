import{r as n,j as s}from"./app-CLtd0l1O.js";import{b as N,H as k,P as h}from"./index-CsmzVUu1.js";import S from"./ChoiceSourceHandle-DZ3aU89a.js";import{g as M}from"./utils-DnMOXxyc.js";import{u as F}from"./store-Bh6xa2Wy.js";import{F as H,a as P}from"./index-DfVLiIJs.js";import{G as R}from"./iconBase-B1NUaL_I.js";import{F as T}from"./index-CJy3gCXu.js";import{c as d,S as O,s as V,a as $}from"./salesPoints-Y2rWhV46.js";import"./react-CHX_hP92.js";function z(o){return R({tag:"svg",attr:{fill:"currentColor",viewBox:"0 0 16 16"},child:[{tag:"path",attr:{d:"M3 9.5a1.5 1.5 0 1 1 0-3 1.5 1.5 0 0 1 0 3m5 0a1.5 1.5 0 1 1 0-3 1.5 1.5 0 0 1 0 3m5 0a1.5 1.5 0 1 1 0-3 1.5 1.5 0 0 1 0 3"},child:[]}]})(o)}const A=({id:o,data:r})=>{const[E,m]=n.useState([]),{firstNodeId:p,setFirstNodeId:L}=F(),{setEdges:g,updateNodeData:a}=N(),{show:x}=T({id:"cityheaven-qestion-menu-id"}),f=(e,t)=>{x({event:e,props:{flowId:t}})},b=n.useCallback(e=>{a(o,{...r,topic:e.currentTarget.value})},[a,o,r]),v=n.useCallback(()=>{const e=M();a(o,{...r,choices:[...r.choices,{id:e,content:""}]})},[a,o,r]),j=n.useCallback((e,t)=>{if(r.choices.length>6)return;const l=e.currentTarget.value;a(o,{...r,choices:r.choices.map(i=>i.id===t.id?{...i,content:l}:i)})},[a,o,r]),y=n.useCallback(e=>{r.choices.length<=1||(a(o,{...r,choices:r.choices.filter(t=>t.id!=e.id)}),g(t=>t.filter(l=>l.sourceHandle!=e.id)))},[a,o,r]),w=n.useCallback((e,t)=>{t&&(a(o,{...r,choices:r.choices.map(l=>l.id===e?{...l,salePoints:t}:l)}),m(t))},[o,r,a,m]),C=n.useMemo(()=>({control:(e,t)=>({...e,width:"100%",borderRadius:"none",border:"none",backgroundColor:"transparent",fontSize:"0.7rem",textAlign:"center",boxShadow:"none","&:hover":{border:"none",cursor:"pointer"}}),input:e=>({...e,"input:focus":{boxShadow:"none",outline:"none"}}),option:(e,{data:t,isDisabled:l,isFocused:i,isSelected:c})=>{const u=d("indigo");return{...e,backgroundColor:l?void 0:c?"indigo":i?u.alpha(.1).css():void 0,color:l?"#ccc":c?d.contrast(u,"white")>2?"white":"black":"indigo",cursor:l?"not-allowed":"default",":active":{...e[":active"],backgroundColor:l?void 0:c?"indigo":u.alpha(.3).css()}}},multiValue:(e,{data:t})=>(d("indigo"),{...e,backgroundColor:"#4b008226"}),multiValueLabel:(e,{data:t})=>({...e,color:"black"}),multiValueRemove:(e,{data:t})=>({...e,color:"grey",":hover":{backgroundColor:"purple",color:"white"}}),menu:e=>({...e,marginTop:0,fontSize:"0.65rem"}),valueContainer:(e,t)=>({...e,padding:0})}),[]);return s.jsxs("div",{className:`rounded-md w-72 pb-7 bg-slate-100 shadow-lg
      ${p===o&&"border-2 border-orange-300"}`,children:[s.jsx("div",{className:"custom-drag-handle rounded-t-md bg-slate-900 flex justify-end items-center h-8 pr-2",children:s.jsx(z,{className:" h-full text-slate-400 text-sm cursor-pointer transition-all hover:text-slate-300 hover:bg-slate-800 rounded",onClick:e=>f(e,0)})}),s.jsxs("div",{className:"flex flex-col justify-center items-center pt-2 px-4 ",children:[s.jsxs("div",{className:"w-full flex flex-col justify-center items-center relative",children:[s.jsx("label",{htmlFor:"message",className:"self-start block text-sm font-medium text-slate-600",children:"質問内容"}),s.jsx("textarea",{id:"message",rows:3,className:"block resize-none p-2.5 w-full text-sm text-gray-900 placeholder-gray-300 bg-gray-50 rounded-sm border border-gray-300 focus:ring-slate-400 focus:border-slate-400",value:r.topic,onChange:e=>b(e),placeholder:"質問内容を入力してください"}),s.jsx(k,{id:o,position:h.Left,type:"target",style:{cursor:"pointer",top:18,left:-25}})]}),s.jsxs("div",{className:"w-full flex flex-col justify-center items-center pt-4",children:[s.jsx("div",{className:"self-start block text-sm font-medium text-slate-600",children:"選択肢"}),r.choices.map(e=>s.jsxs("div",{className:"w-full relative",children:[s.jsxs("div",{className:"w-full flex justify-between",children:[s.jsx("input",{className:"w-full text-sm border-none hover:shadow focus:ring-0 bg-gray-50 text-gray-900 placeholder-gray-300",value:e.content,placeholder:"選択肢を入力してください",onChange:t=>j(t,e)}),s.jsx("button",{className:"text-center text-red-200 transition-all hover:text-red-500 px-1",type:"button",onClick:()=>y(e),children:s.jsx(H,{className:"text-sm"})})]}),s.jsx(O,{instanceId:`${e.id}-s`,closeMenuOnSelect:!1,defaultValue:e.salePoints,options:V,onChange:t=>t?w(e.id,[...t]):null,noOptionsMessage:()=>"セールスポイントが見つかりません",placeholder:"セールスポイントを選んでください",isSearchable:!0,isMulti:!0,components:{IndicatorSeparator:()=>null,DropdownIndicator:()=>null,Menu:t=>s.jsx($.Menu,{...t,className:"nowheel"})},styles:C}),s.jsx(S,{id:e.id,type:"source",position:h.Right,connectionLimit:1,style:{top:18,right:-25}})]},e.id))]}),s.jsx("div",{className:"w-full mt-4",children:r.choices.length<6&&s.jsxs("button",{className:"text-gray-600 border border-gray-600 hover:text-gray-300 hover:border-gray-300 font-bold mt-1 w-full text-[0.8rem] py-1 flex justify-center items-center gap-1 transition-all",onClick:()=>v(),children:[s.jsx(P,{}),s.jsx("p",{children:"選択肢追加"})]})})]})]})},Z=n.memo(A);export{Z as default};
