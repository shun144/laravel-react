import{r as t,j as o}from"./app-CBSrSIhT.js";import{u as S,a as q,b as D,c as I,r as A,i as B,S as T,B as Q,d as V,C as F}from"./index-BxZoQ102.js";import{g as M,Q as X,a as Y,b as u}from"./QuizeNode-DWkff4cS.js";import G from"./ResultNode-Djrj71Yw.js";import{D as L}from"./core.esm-Blu4ffkx.js";import{Draggable as g}from"./Draggable-B-3ToKJY.js";import{Droppable as O}from"./Droppable-CBwTHmrP.js";import"./ChoiceSourceHandleProps-r9vvmzxY.js";import"./index-SudRYcli.js";import"./iconBase-BZeQPJ4Z.js";import"./DraggableBlockSource-Dc11W56D.js";const P=M(),_=Y(),ne=()=>{const[p,$,m]=S(P),[f,r,b]=q(_),{screenToFlowPosition:x,getNodes:i,addNodes:c}=D(),N=t.useMemo(()=>({quizeNode:X,resultNode:G}),[]),d=t.useRef(!0),h=t.useCallback(s=>{r(e=>I({...s,type:"smoothstep"},e))},[]),E=t.useCallback(()=>{d.current=!1},[]),j=t.useCallback((s,e)=>{d.current=!0,r(n=>A(s,e,n))},[]),C=t.useCallback((s,e)=>{d.current||r(n=>n.filter(a=>a.id!==e.id)),d.current=!0},[]),R=s=>{const e=u(i(),"quize-");c({id:e,data:{quizeNo:e,topic:"",choices:[{choiceNo:`${e}-1`,content:""}]},position:s,type:"quizeNode"})},w=s=>{const e=u(i(),"result-");c({id:e,data:{resultNo:e,message:""},position:s,type:"resultNode"})},y=t.useCallback(({active:s,over:e,delta:n,activatorEvent:a})=>{if(!(e==null||e.id!="droppableA")&&a instanceof MouseEvent){const z=a.pageX+n.x,k=a.pageY+n.y,l=x({x:z,y:k});s.id==="draggable-quize"&&R(l),s.id==="draggable-result"&&w(l)}},[]);return o.jsx("div",{className:"flex h-full",children:o.jsxs(L,{onDragEnd:y,children:[o.jsxs("div",{className:"w-[10%] flex items-center flex-col gap-y-3 pt-3 bg-slate-800",children:[o.jsx(g,{id:"draggable-quize",label:"質問追加"}),o.jsx(g,{id:"draggable-result",label:"結果追加"})]}),o.jsx(O,{id:"droppableA",children:o.jsxs(B,{nodes:p,edges:f,nodeTypes:N,edgeTypes:{smoothstep:T},onEdgesChange:b,onNodesChange:m,fitView:!0,fitViewOptions:{padding:.2},snapToGrid:!0,onReconnect:j,onReconnectStart:E,onReconnectEnd:C,onConnect:h,children:[o.jsx(Q,{color:"#222",variant:V.Lines,gap:20}),o.jsx(F,{})]})})]})})};export{ne as default};
