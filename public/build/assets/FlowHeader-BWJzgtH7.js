import{r as s,q as U,j as e,y as H}from"./app-BMXDJVyd.js";import{u as a}from"./store-C-TAy8r_.js";import{u as J}from"./index-DYGodSJL.js";import{n as g}from"./index-BqrmyCi8.js";import{M}from"./index-BwFwFSRL.js";import{M as z}from"./react-tooltip.min-B3v_n3RK.js";import"./react-tooltip.min-DZcZWJaY.js";import"./react-BQFNYpn0.js";import"./iconBase-DyeLHBi8.js";import"./floating-ui.dom-D0k0YRlw.js";const V=({id:n,initialTitle:w,initialUrl:b})=>{const{props:y}=U(),c=y.auth.user.english_name,[d,j]=s.useState(w),[u,v]=s.useState(b),[r,x]=s.useState({}),{getNodes:N,getEdges:S,getViewport:C}=J(),k=a(t=>t.firstNodeId),i=a(t=>t.setIsDirty),D=a(t=>t.isDirty),m=s.useRef(null),[f,p]=s.useState(!1),O=t=>{t.preventDefault();const o=N(),h=S(),$=o.filter(l=>l.type==="qNode"),q=o.filter(l=>l.type==="rNode"),{x:E,y:F,zoom:I}=C();H.post(`/flow/${n}`,{update_questions:JSON.stringify($),update_results:JSON.stringify(q),update_edges:JSON.stringify(h),first_question_id:k,title:d,url:u,x:E,y:F,zoom:I},{onSuccess:()=>{x({}),g.success("保存しました",{duration:4e3}),i(!1)},onError:l=>{x(l);for(const L of Object.values(l))g.error(L,{duration:5e3})}})},R=s.useCallback(t=>{j(t.currentTarget.value),i(!0)},[]),T=t=>{v(t.target.value),i(!0)},_=async t=>{var o;try{t.preventDefault(),await navigator.clipboard.writeText(`${window.location.origin}/${c}/${(o=m.current)==null?void 0:o.value}`),p(!0),setTimeout(()=>p(!1),2e3)}catch{}};return e.jsx("div",{className:"h-14 w-full bg-white",children:e.jsx("div",{className:"h-full w-full flex justify-center items-center bg-slate-100",children:e.jsxs("form",{onSubmit:O,className:"w-full h-14 flex justify-between items-center",children:[e.jsxs("div",{className:"h-full w-2/12 flex justify-between items-center",children:[e.jsx("div",{className:"text-gray-500/70 font-bold text-lg pl-4",children:`ID:${n}`}),e.jsx("div",{className:"h-10 w-16",children:e.jsxs("button",{className:"relative w-full h-full bg-indigo-500 px-2 text-white rounded-md shadow-xl transition-all hover:bg-indigo-600 select-none hover:shadow-xl duration-200",children:["保 存",D&&e.jsxs("span",{className:"absolute flex h-3 w-3 -top-1 -right-1",children:[e.jsx("span",{className:"animate-ping absolute inline-flex h-full w-full rounded-full bg-rose-400 opacity-75"}),e.jsx("span",{className:"relative inline-flex rounded-full h-3 w-3 bg-rose-500 opacity-85"})]})]})})]}),e.jsxs("div",{className:"flex justify-start items-center pl-20 gap-x-10 w-10/12",children:[e.jsxs("div",{className:" flex flex-col items-center w-96",children:[e.jsx("div",{children:r.title&&e.jsx("div",{className:"text-sm text-red-500",children:r.title})}),e.jsxs("div",{className:"flex w-full flex-row items-center",children:[e.jsx("label",{htmlFor:"title",className:"block text-sm font-medium text-gray-800 h-10 leading-10  text-center",children:"タイトル："}),e.jsx("input",{type:"text",id:"title",placeholder:"タイトルを入力してください",maxLength:50,className:"grow bg-white border border-slate-400 text-gray-900 text-sm focus:ring-transparent focus:border-blue-400 block  p-2.5 h-full placeholder-slate-400 rounded",onChange:R,value:d})]})]}),e.jsxs("div",{className:" flex flex-col items-center w-96",children:[e.jsx("div",{children:r.url&&e.jsx("div",{className:"text-sm text-red-500",children:r.url})}),e.jsxs("div",{className:"flex w-full flex-row items-center",children:[e.jsx("label",{htmlFor:"url",className:"block text-sm font-medium text-gray-800 h-10 leading-10  text-center",children:"URL："}),e.jsxs("div",{className:"text-gray-400 border-slate-300 pr-1",children:[window.location.origin,"/",c,"/"]}),e.jsx("input",{type:"text",id:"url",placeholder:"URLを入力してください",maxLength:15,ref:m,className:`grow bg-white  text-gray-900 text-sm focus:ring-transparent  block  p-2.5 h-full placeholder-slate-400 rounded ${r.url?"border-rose-300 focus:border-rose-400 border-2":"border-slate-400 focus:border-blue-400 border"} `,onChange:T,value:u}),e.jsx("button",{"data-tooltip-id":"my-tooltip","data-tooltip-content":"URLをコピーしました",onClick:_,className:"pl-2 py-2 text-indigo-400 rounded transition-all hover:text-indigo-800 duration-300",children:e.jsx(M,{})}),f&&e.jsx(z,{id:"my-tooltip",place:"top",style:{background:"#6366f1",fontSize:"12px",padding:"4px 8px"},openOnClick:!0,isOpen:f})]})]})]})]})})})},ee=s.memo(V);export{ee as default};
